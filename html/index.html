<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN">
<html><head><meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>CLISH: Main Page</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
<link href="tabs.css" rel="stylesheet" type="text/css">
</head><body>
<!-- Generated by Doxygen 1.5.1 -->
<div class="tabs">
  <ul>
    <li id="current"><a href="index.html"><span>Main&nbsp;Page</span></a></li>
    <li><a href="modules.html"><span>Modules</span></a></li>
    <li><a href="annotated.html"><span>Data&nbsp;Structures</span></a></li>
    <li><a href="files.html"><span>Files</span></a></li>
    <li><a href="dirs.html"><span>Directories</span></a></li>
    <li><a href="pages.html"><span>Related&nbsp;Pages</span></a></li>
  </ul></div>
<h1>CLISH Documentation</h1>
<p>
<h3 align="center">0.7.3 </h3><h2><a class="anchor" name="abstract">
Abstract</a></h2>
A modular framework for implementing a CISCO-like CLI on a *NIX system. Arbitary command menus and actions can be defined using XML files. This software handles the user interaction, and forks the appropriate system commands to perform any actions.<p>
<ul>
<li><a class="el" href="_licence_page.html">Licence</a></li><li><a class="el" href="_changes_page.html">Changes</a></li><li><a class="el" href="_issues_page.html">Issues</a></li></ul>
<h2><a class="anchor" name="downloads">
Downloads</a></h2>
This project is hosted on <a href="http://sourceforge.net/projects/clish/">sourceforge.</a> from where the source-code can be downloaded.<h2><a class="anchor" name="background">
Background</a></h2>
The CISCO-like CLI has become a de-facto standard in the domain of network devices. It is a much more restricted interface than traditional *NIX shells, hence is simpler to use and inherently more secure. As more devices move to using an embedded *NIX operating systems, a simple, scalable means of producing such a CLI becomes valuable.<h2><a class="anchor" name="existing">
Existing Solutions</a></h2>
<h3><a class="anchor" name="Libcli">
Libcli</a></h3>
<a href="http://libcli.sourceforge.net/">Libcli</a> provides a similar facility but has the following main limitations:-<p>
1) In order to add new commands a monolithic executable (which uses the library) needs to be recompiled, after editing the source code to add the newly required commands and actions.<p>
2) libcli takes responsiblity for attaching to a socket (telnet-like). This limits the usage of the CLI; difficult to use over SSH for example, similarly cannot get the menus directly from an existing shell.<p>
3) The implementation of the command actions is hard-linked into the monolithic executable, this can cause licence concerns/issues when a commercial company wishes to control proprietry software from within the CLI.<p>
4) libcli takes responsiblity for the authentication of the user. This is different from other "shells" which do not deal with authentication, but are simply spawned as the required user.<h3><a class="anchor" name="GNU-zebra">
GNU-zebra</a></h3>
<a href="http://www.zebra.org/">Zebra</a> is a routing package, and comes with it's own integrated CLI, to handle its configuration (VTYSH).<h2><a class="anchor" name="project">
CLISH Project</a></h2>
The project is written (mostly) in ANSI-C and provides two example executables which can be used as a drop-in replacement for a more conventional "shell".<p>
The software was initially developed as part of some internal work at 3Com and due to the dependancy on 3rd party open-source packages, and it's self contained nature, it is being released into the public domain.<p>
It is designed to run on any *NIX system e.g. Linux, BSD, Cygwin and makes use of the following other opensource packages (glibc,tinyxml,doxygen)<h3><a class="anchor" name="clish">
clish  (pronounced see-lish)</a></h3>
This application is a standard UNIX shell replacement. The ACTION tags in the XML specification are mapped to the system() call and hence will be interpreted as a Bourne-shell script.<h3><a class="anchor" name="tclish">
tclish (pronounced tickle-ish)</a></h3>
This application is built if the TCL libraries are present on the build system. The name of the executable produced will reflect the version of TCL used. e.g. tclish8.4 will be generated if TCL8.4 is present on the system.<p>
This application will spawn a TCL interpreter when started, and the contents of the ACTION tags will be interpreted as TCL scripts within that interpreter for the duration of the shell.<h3><a class="anchor" name="Features">
Features</a></h3>
The "clish" shell has the following features:-<p>
<ul>
<li>Provides CLI tree handling facilities<ul>
<li>Tree built from multiple XML encoded files. (uses tinyxml) This means that XML configuration files can be be made part of 3rd party packages and simply installing them integrates commands into the CLI.</li></ul>
</li></ul>
<p>
<ul>
<li>Access permissions are defined as part of the CLI tree definition; a CLI node/branch may be limited to a specific *NIX group.</li></ul>
<p>
<ul>
<li>Provides interface to user<ul>
<li>Handles auto-completion of commands</li><li>Only appropriate commands for the current user's "group" will be available.</li><li>Provides parameter type verification facility Each parameter may be of a specific type, which the framework will ensure is correctly entered by the user.</li><li>Provides key-handling for the interface (uses tinyrl) Provides command line editing facilities up/down arrow keys [TAB] command completion [CTRL-A] move to start of command line [?] provides context sensitive help.</li></ul>
</li></ul>
<p>
<ul>
<li>Able to be launched non-interactively<ul>
<li>textual scripts can be written to drive the CLI</li></ul>
</li></ul>
<p>
<ul>
<li>Executes a specified CLI command by launching the appropriate (as defined in the CLI tree) system command line to perform the required action<ul>
<li>Only commands permitted for the current user are available.</li><li>During execution the I/O streams are handed over to the new program.</li><li>Able to spawn a 3rd party shell, where necessary This will take over control of the I/O channel until that sub-shell exits.</li></ul>
</li></ul>
<p>
"clish" makes use of multiple XML files to define it's behaviour these...<p>
<ul>
<li>Identify scope of the commands (global or specific view(s))</li></ul>
<p>
<ul>
<li>Include access permissions. By default a command will be accessible to all users, but the schema will provide the ability to limit the command based on UNIX group membership.</li></ul>
<p>
<ul>
<li>Includes help text for menus</li></ul>
<p>
<ul>
<li>Includes parameter definitions (with types where appropriate)</li></ul>
<p>
<ul>
<li>Includes prompt modifications (different views)</li></ul>
<p>
<ul>
<li>Includes full command line which each leaf node should execute to achieve result.</li></ul>
<p>
<ul>
<li>Separate set of files for each localization (language) can be provided and determined by the user logging in.</li></ul>
<p>
<ul>
<li>"packages" can contribute files to define their facilities within the CLI; this makes augmentation of the CLI as simple as including/excluding a particular package.</li></ul>
<h2><a class="anchor" name="example">
xml-example directory</a></h2>
<div class="fragment"><pre class="fragment">This directory contains some example XML files which indicate some
of what can be acheived with the CLISH library.

The action fields are 'sh' scripts and were developed and
tested on a cygwin system so some  of the command options to
things like <span class="stringliteral">"ping"</span> may be different on different systems. 
(you should only need to change the ACTION tag to get them to work...) 

To use these files set CLISH_PATH to point to <span class="keyword">this</span> directory and 
launch clish.

\note
Thanks to Tom Williams who gave me the basis <span class="keywordflow">for</span> the
<span class="stringliteral">"clock"</span> command example.
</pre></div><p>
Some of the example files are put here for reference:<h3><a class="anchor" name="global_xml">
global-command.xml</a></h3>
<div class="fragment"><pre class="fragment">&lt;?xml version=<span class="stringliteral">"1.0"</span> encoding=<span class="stringliteral">"UTF-8"</span>?&gt;
&lt;CLISH_MODULE xmlns=<span class="stringliteral">"http://clish.sourceforge.net/XMLSchema"</span> 
          xmlns:xsi=<span class="stringliteral">"http://www.w3.org/2001/XMLSchema-instance"</span> 
 xsi:schemaLocation=<span class="stringliteral">"http://clish.sourceforge.net/XMLSchema</span>
<span class="stringliteral">                     http://clish.sourceforge.net/XMLSchema/clish.xsd"</span>&gt;
    &lt;!--=======================================================--&gt;
    &lt;COMMAND name=<span class="stringliteral">"help"</span>
             help=<span class="stringliteral">"Display an overview of the CLI syntax"</span>&gt;
        &lt;ACTION builtin=<span class="stringliteral">"clish_overview"</span>/&gt;
    &lt;/COMMAND&gt;
    &lt;!--=======================================================--&gt;
    &lt;COMMAND name=<span class="stringliteral">"logout"</span>
             help=<span class="stringliteral">"Logout of the current CLI session"</span>&gt;
        &lt;ACTION builtin=<span class="stringliteral">"clish_close"</span>/&gt;
    &lt;/COMMAND&gt;
    &lt;!--=======================================================--&gt;
    &lt;COMMAND name=<span class="stringliteral">"top"</span>
             help=<span class="stringliteral">"Return to the default mode"</span>
             view=<span class="stringliteral">"root-view"</span>
             viewid=<span class="stringliteral">""</span>/&gt;
    &lt;!--=======================================================--&gt;
    &lt;COMMAND name=<span class="stringliteral">"debug"</span>
             help=<span class="stringliteral">"Change to the debug mode"</span>
             view=<span class="stringliteral">"debug-view"</span>&gt;
       &lt;ACTION&gt;echo <span class="stringliteral">"Entering debug mode..."</span>&lt;/ACTION&gt;
    &lt;/COMMAND&gt;
    &lt;!--=======================================================--&gt;
    &lt;COMMAND name=<span class="stringliteral">"script"</span>
             help=<span class="stringliteral">"Change to the script demo mode"</span>
             view=<span class="stringliteral">"script-view"</span>/&gt;
    &lt;!--=======================================================--&gt;
    &lt;COMMAND name=<span class="stringliteral">"history"</span>
             help=<span class="stringliteral">"Display the current session's command line history"</span>&gt;
        &lt;PARAM name=<span class="stringliteral">"limit"</span>
               help=<span class="stringliteral">"Set the size of history list (zero means unbounded)"</span>
              ptype=<span class="stringliteral">"UINT"</span>
            <span class="keywordflow">default</span>=<span class="stringliteral">""</span>/&gt;
        &lt;ACTION builtin=<span class="stringliteral">"clish_history"</span>&gt;${limit}&lt;/ACTION&gt;
    &lt;/COMMAND&gt;
    &lt;!--=======================================================--&gt;
&lt;/CLISH_MODULE&gt;
</pre></div><h3><a class="anchor" name="startup_xml">
startup.xml</a></h3>
<div class="fragment"><pre class="fragment">&lt;?xml version=<span class="stringliteral">"1.0"</span> encoding=<span class="stringliteral">"UTF-8"</span>?&gt;
&lt;CLISH_MODULE xmlns=<span class="stringliteral">"http://clish.sourceforge.net/XMLSchema"</span> 
          xmlns:xsi=<span class="stringliteral">"http://www.w3.org/2001/XMLSchema-instance"</span> 
 xsi:schemaLocation=<span class="stringliteral">"http://clish.sourceforge.net/XMLSchema</span>
<span class="stringliteral">                     http://clish.sourceforge.net/XMLSchema/clish.xsd"</span>&gt;
    &lt;!--=======================================================--&gt;
    &lt;OVERVIEW&gt;
CONTEXT SENSITIVE HELP
[?] - Display context sensitive help. This is either a list of possible
      command completions with summaries, or the full syntax of the 
      current command. A subsequent repeat of <span class="keyword">this</span> key, when a command
      has been resolved, will display a detailed reference.

AUTO-COMPLETION
The following keys both perform <span class="keyword">auto</span>-completion <span class="keywordflow">for</span> the current command line.
If the command prefix is not unique then the bell will ring and a subsequent
repeat of the key will display possible completions.

[enter] - Auto-completes, syntax-checks then executes a command. If there is 
          a syntax error then offending part of the command line will be
          highlighted and explained.

[space] - Auto-completes, or <span class="keywordflow">if</span> the command is already resolved inserts a space.

MOVEMENT KEYS
[CTRL-A] - Move to the start of the line
[CTRL-E] - Move to the end of the line.
[up]     - Move to the previous command line held in history.
[down]   - Move to the next command line held in history.
[left]   - Move the insertion point left one character.
[right]  - Move the insertion point right one character.

DELETION KEYS
[CTRL-C]    - Delete and abort the current line
[CTRL-D]    - Delete the character to the right on the insertion point.
[CTRL-K]    - Delete all the characters to the right of the insertion point.
[CTRL-U]    - Delete the whole line.
[backspace] - Delete the character to the left of the insertion point.

ESCAPE SEQUENCES
!!  - Subsitute the the last command line.
!N  - Substitute the Nth command line (absolute as per 'history' command)
!-N - Substitute the command line entered N lines before (relative)
    &lt;/OVERVIEW&gt;
    &lt;!--=======================================================--&gt;
    &lt;STARTUP view=<span class="stringliteral">"root-view"</span>&gt;
        &lt;DETAIL&gt;
********************************************
*         CLISH (see-lish)                 *
*                                          *
*      WARNING: Authorised Access Only     *
********************************************
        &lt;/DETAIL&gt;
        &lt;ACTION&gt;echo <span class="stringliteral">"Welcome `whoami` it is `date`"</span>&lt;/ACTION&gt;
    &lt;/STARTUP&gt;
    &lt;!--=======================================================--&gt;
&lt;/CLISH_MODULE&gt;
</pre></div><h3><a class="anchor" name="types_xml">
types.xml</a></h3>
<div class="fragment"><pre class="fragment">&lt;?xml version=<span class="stringliteral">"1.0"</span> encoding=<span class="stringliteral">"UTF-8"</span>?&gt;
&lt;CLISH_MODULE xmlns=<span class="stringliteral">"http://clish.sourceforge.net/XMLSchema"</span> 
          xmlns:xsi=<span class="stringliteral">"http://www.w3.org/2001/XMLSchema-instance"</span> 
 xsi:schemaLocation=<span class="stringliteral">"http://clish.sourceforge.net/XMLSchema</span>
<span class="stringliteral">                     http://clish.sourceforge.net/XMLSchema/clish.xsd"</span>&gt;
    &lt;!--=======================================================--&gt;
    &lt;PTYPE name=<span class="stringliteral">"VLAN_ID"</span> 
        pattern=<span class="stringliteral">"(409[0-5]|40[0-8][0-9]|[1-3][0-9]{3}|[1-9][0-9]{2}|[1-9][0-9]|[1-9])"</span>
           help=<span class="stringliteral">"Number in the range 1-4095"</span>/&gt;
    &lt;!--=======================================================--&gt;
    &lt;PTYPE name=<span class="stringliteral">"IP_ADDR"</span>
        pattern=<span class="stringliteral">"(((25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?)\.){3}(25[0-5]|2[0-4][0-9]|[01]?[0-9][0-9]?))"</span>
           help=<span class="stringliteral">"IP address AAA.BBB.CCC.DDD where each part is in the range 0-255"</span>/&gt;
    &lt;!--=======================================================--&gt;
    &lt;PTYPE name=<span class="stringliteral">"UINT"</span>
        pattern=<span class="stringliteral">"[0-9]+"</span>
           help=<span class="stringliteral">"Unsigned integer"</span>/&gt;
    &lt;!--=======================================================--&gt;
    &lt;PTYPE name=<span class="stringliteral">"STRING"</span>
        pattern=<span class="stringliteral">"[^\-]+"</span>
           help=<span class="stringliteral">"String"</span>/&gt;
    &lt;!--=======================================================--&gt;
    &lt;PTYPE name=<span class="stringliteral">"BOOL"</span>
        pattern=<span class="stringliteral">"true(1) false(0)"</span>
           help=<span class="stringliteral">"Boolean choice"</span>/&gt;
    &lt;!--=======================================================--&gt;
&lt;/CLISH_MODULE&gt;
</pre></div><h3><a class="anchor" name="debug_xml">
debug-view.xml</a></h3>
<div class="fragment"><pre class="fragment">&lt;?xml version=<span class="stringliteral">"1.0"</span> encoding=<span class="stringliteral">"UTF-8"</span>?&gt;
&lt;CLISH_MODULE xmlns=<span class="stringliteral">"http://clish.sourceforge.net/XMLSchema"</span> 
          xmlns:xsi=<span class="stringliteral">"http://www.w3.org/2001/XMLSchema-instance"</span> 
 xsi:schemaLocation=<span class="stringliteral">"http://clish.sourceforge.net/XMLSchema</span>
<span class="stringliteral">                     http://clish.sourceforge.net/XMLSchema/clish.xsd"</span>&gt;
    &lt;VIEW name=<span class="stringliteral">"debug-view"</span> prompt=<span class="stringliteral">"debug&gt; "</span>&gt;
        &lt;COMMAND name=<span class="stringliteral">"sh"</span>
                 help=<span class="stringliteral">"launch a full shell"</span>&gt;
            &lt;ACTION&gt;bash&lt;/ACTION&gt;
        &lt;/COMMAND&gt;

        &lt;COMMAND name=<span class="stringliteral">"ps"</span>
                 help=<span class="stringliteral">"give details of current processes"</span>&gt;
            &lt;ACTION&gt;ps -f&lt;/ACTION&gt;
        &lt;/COMMAND&gt;

        &lt;COMMAND name=<span class="stringliteral">"ls"</span>
                 help=<span class="stringliteral">"List the files in the current directory"</span>&gt;
                &lt;ACTION&gt;echo ${PWD};ls -F -l -a&lt;/ACTION&gt;
        &lt;/COMMAND&gt;

        &lt;COMMAND name=<span class="stringliteral">"exit"</span>
                 help=<span class="stringliteral">"Go back to main menu"</span>
                 view=<span class="stringliteral">"root-view"</span>&gt;
            &lt;ACTION&gt;echo <span class="stringliteral">"Leaving diagnostic mode..."</span>&lt;/ACTION&gt;
        &lt;/COMMAND&gt;
    &lt;/VIEW&gt;

&lt;/CLISH_MODULE&gt;
</pre></div> <hr size="1"><address style="align: right;"><small>Generated on Tue Apr 29 13:41:07 2008 for CLISH by&nbsp;
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.png" alt="doxygen" align="middle" border="0"></a> 1.5.1 </small></address>
</body>
</html>
